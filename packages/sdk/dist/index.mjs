var o=class{constructor(e){if(!e.baseUrl)throw new Error("baseUrl is required");if(!e.apiKey)throw new Error("apiKey is required");this.baseUrl=e.baseUrl.replace(/\/+$/,""),this.apiKey=e.apiKey;}setConsentToken(e){if(!e)throw new Error("Consent token cannot be empty");this.consentToken=e;}async queryAnonymized(e){if(!this.consentToken)return {success:!1,error:"Consent token not set. Call setConsentToken() first.",details:"A consent token is required for all data queries to ensure user privacy consent."};if(!e.category)return {success:!1,error:"category is required",details:'Specify the data category to query (e.g., "health", "activity", "demographics")'};if(!e.purpose)return {success:!1,error:"purpose is required",details:'Specify the purpose of the query (e.g., "research", "analytics")'};let t=e.epsilon??1,i=e.aggregations??["mean"];if(t<=0||t>10)return {success:!1,error:"Invalid epsilon value",details:"Epsilon must be between 0 (exclusive) and 10 (inclusive). Lower values provide more privacy."};let a=["mean","sum","count","min","max","stddev"],c=i.filter(s=>!a.includes(s));if(c.length>0)return {success:!1,error:"Invalid aggregation functions",details:`Unsupported aggregations: ${c.join(", ")}. Supported: ${a.join(", ")}`};try{let s=`${this.baseUrl}/api/pdp/query`,u={category:e.category,purpose:e.purpose,epsilon:t,aggregations:i,consentToken:this.consentToken},n=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`,"User-Agent":"MyPriv360-SDK/1.0.0"},body:JSON.stringify(u)}),r=await n.json();return n.ok?r.success?{success:!0,data:{results:r.results||{},epsilon:r.epsilon||t,category:e.category,purpose:e.purpose,timestamp:r.timestamp||new Date().toISOString(),recordCount:r.recordCount||0}}:{success:!1,error:r.error||"Query failed",details:r.details||"No additional error details provided"}:{success:!1,error:r.error||`HTTP ${n.status}: ${n.statusText}`,details:r.details||"Request failed with no additional details"}}catch(s){return {success:!1,error:"Request failed",details:`Network or parsing error: ${s instanceof Error?s.message:"Unknown error occurred"}`}}}getBaseUrl(){return this.baseUrl}hasConsentToken(){return !!this.consentToken}clearConsentToken(){this.consentToken=void 0;}},p=o;

export { o as MyPriv360, p as default };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.mjs.map